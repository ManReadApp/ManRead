syntax = "proto2";

package v1;

import "v1/auth/role_token.proto";

message Claim {
  required string id = 1;
  required Role role = 2;

  required JwtType type = 3;

  required uint64 exp = 4;
}

enum JwtType {
  JWT_TYPE_UNSPECIFIED = 0;
  JWT_TYPE_ACCESS_TOKEN = 1;
  JWT_TYPE_REFRESH_TOKEN = 2;
}

message JWTsResponse {
  required string access_token = 1;
  required string refresh_token = 2;
}

message TokenInfo {
  required string token_id = 1;

  optional string user_id = 2;

  required ActivationTokenKind kind = 3;
}

enum TokenKind {
  TOKEN_KIND_UNSPECIFIED = 0;
  TOKEN_KIND_ACCESS = 1;
  TOKEN_KIND_REFRESH = 2;
}

message TokenRefreshRequest {
  required string refresh_token = 1;
}
